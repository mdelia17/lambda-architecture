@ECHO OFF

docker run --rm --network net-cassandra bitnami/cassandra:3.11.10 cqlsh -e "create keyspace if not exists dns_streaming with replication = {'class': 'NetworkTopologyStrategy', 'DC1': 1};create table if not exists dns_streaming.nameservers (address inet primary key, packets_sent counter, packets_received counter);create table if not exists dns_streaming.searched_categories (category text primary key, requests counter);create table if not exists dns_streaming.message_types (type text primary key, packets counter);create table if not exists dns_streaming.domain_requests_and_responses (request_response text, type text, requests counter, primary key(request_response,type));create table if not exists dns_streaming.conversations (conversation_id tuple<text,text,text> primary key, messages list<text>);create table if not exists dns_streaming.window_domain_requests_and_responses (start timestamp, end timestamp, type text, request_response text, requests counter, primary key (start, end, type, request_response));create table if not exists dns_streaming.window_exchanged_packets (start timestamp, end timestamp, address inet, packets_sent counter, packets_received counter, primary key (start, end, address));create table if not exists dns_streaming.window_bytes_packets (start timestamp, end timestamp, bytes counter, packets counter, PRIMARY KEY (start, end));create table if not exists dns_streaming.window_message_types (start timestamp, end timestamp, type text, count counter, primary key (start, end, type));create table if not exists dns_streaming.errors (address inet primary key, errors counter);truncate dns_streaming.nameservers;truncate dns_streaming.searched_categories;truncate dns_streaming.message_types;truncate dns_streaming.domain_requests_and_responses;truncate dns_streaming.conversations;truncate dns_streaming.window_domain_requests_and_responses;truncate dns_streaming.window_exchanged_packets;truncate dns_streaming.window_byte_sums;truncate dns_streaming.window_message_types;truncate dns_streaming.errors;create keyspace if not exists dns_batch with replication = {'class': 'NetworkTopologyStrategy', 'DC1': 1};create table if not exists dns_batch.total_avg_bytes(address_a inet, address_b inet, total int, avg float, count int, primary key (address_a,address_b));create table if not exists dns_batch.requests_responses_uniquehosts (type text, request_response text, count int, hosts set<inet>, primary key (type,request_response));create table if not exists dns_batch.hosts(host inet primary key);truncate dns_batch.total_avg_bytes;truncate dns_batch.requests_responses_uniquehosts; truncate dns_batch.hosts;exit;" --username cassandra --password cassandra cassandra-1